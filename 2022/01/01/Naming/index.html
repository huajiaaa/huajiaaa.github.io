<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Software Complexity：Naming - 温酒写 bug</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="温酒写 bug"><meta name="msapplication-TileImage" content="/favicon/favicon-16x16"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="温酒写 bug"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="apple-touch-icon" sizes="16*16" href="/favicon/favicon-16x16"><meta name="description" content="原文：https:&amp;#x2F;&amp;#x2F;alexoliveira.cc&amp;#x2F;software-naming.html 并非逐句逐词，而是根据自己的理解进行了翻译。"><meta property="og:type" content="blog"><meta property="og:title" content="Software Complexity：Naming"><meta property="og:url" content="http://huajiaaa.com/2022/01/01/Naming/"><meta property="og:site_name" content="温酒写 bug"><meta property="og:description" content="原文：https:&amp;#x2F;&amp;#x2F;alexoliveira.cc&amp;#x2F;software-naming.html 并非逐句逐词，而是根据自己的理解进行了翻译。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/naming.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/couch-in-what-room.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/toilet-in-what-room.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/toilet-bed.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/clarity-vs-relation.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/car-http.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/builders.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/base.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/arc.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/divide-and-name.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/compound-concepts.png"><meta property="og:image" content="https://alexoliveira.cc/images/posts/software-naming/abstract-canvas.png"><meta property="article:published_time" content="2022-01-01T07:57:26.000Z"><meta property="article:modified_time" content="2022-01-02T16:23:34.314Z"><meta property="article:tag" content="翻译"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://alexoliveira.cc/images/posts/software-naming/naming.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://huajiaaa.com/2022/01/01/Naming/"},"headline":"Software Complexity：Naming","image":["https://alexoliveira.cc/images/posts/software-naming/naming.png","https://alexoliveira.cc/images/posts/software-naming/couch-in-what-room.png","https://alexoliveira.cc/images/posts/software-naming/toilet-in-what-room.png","https://alexoliveira.cc/images/posts/software-naming/toilet-bed.png","https://alexoliveira.cc/images/posts/software-naming/clarity-vs-relation.png","https://alexoliveira.cc/images/posts/software-naming/car-http.png","https://alexoliveira.cc/images/posts/software-naming/builders.png","https://alexoliveira.cc/images/posts/software-naming/base.png","https://alexoliveira.cc/images/posts/software-naming/arc.png","https://alexoliveira.cc/images/posts/software-naming/divide-and-name.png","https://alexoliveira.cc/images/posts/software-naming/compound-concepts.png","https://alexoliveira.cc/images/posts/software-naming/abstract-canvas.png"],"datePublished":"2022-01-01T07:57:26.000Z","dateModified":"2022-01-02T16:23:34.314Z","author":{"@type":"Person","name":null},"publisher":{"@type":"Organization","name":"温酒写 bug","logo":{"@type":"ImageObject","url":"http://huajiaaa.com/favicon/logo.svg"}},"description":"原文：https:&#x2F;&#x2F;alexoliveira.cc&#x2F;software-naming.html 并非逐句逐词，而是根据自己的理解进行了翻译。"}</script><link rel="canonical" href="http://huajiaaa.com/2022/01/01/Naming/"><link rel="icon" href="/favicon/logo.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.0.2"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/favicon/logo.svg" alt="温酒写 bug" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-01-01T07:57:26.000Z" title="2022/1/1 15:57:26">2022-01-01</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">34 分钟读完 (大约5111个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">Software Complexity：Naming</h1><div class="content"><p>原文：<a target="_blank" rel="noopener" href="https://alexoliveira.cc/software-naming.html">https://alexoliveira.cc/software-naming.html</a></p>
<p>并非逐句逐词，而是根据自己的理解进行了翻译。</p>
<a id="more"></a>

<p><img src="https://alexoliveira.cc/images/posts/software-naming/naming.png" alt="The Magic Acid, or the art of naming"></p>
<blockquote>
<p>There are only two hard things in Computer Science: cache invalidation and naming things.</p>
<p>Phil Karlton</p>
</blockquote>
<p>当我们尝试阅读和理解软件系统时，我们希望代码通顺，希望它能用业务领域中的语言/词汇，清晰而准确的传达意图与关系。代码虽然只写一次，但是会被阅读很多次。</p>
<p>烂代码使人迷惑，它是在 “代码对作者有意义，对读者没意义” 的假设或认知下编写的。如果一段代码需要在别人的帮助下才能被理解，或者需要花费与之不相称的巨大努力后才能看懂它在做什么，那就是烂代码。</p>
<p>我们如何才能写出好的代码呢？</p>
<p>在任何领域取得成功的第一步是对其组成元素、以及元素对人和环境的影响有充分的了解。优秀的电影导演在看了无数个小时的电影后，会将电影领域中的元素和规律沉淀/总结下来，然后操纵它们来有效地讲故事。同样的道理也适用于小说家、音乐家、棋手。</p>
<p>类似的，程序猿也应该能够通过观察业务领域并发现其元素和规律。领域中的元素有些很明显，但有些则不然，这就是问题所在：为这些元素起一个名字并非易事，因为有些元素在现实中并不存在；有些元素存在，但缺少每个人都能理解的名称。</p>
<p>有些命名使元素个性化，而有些则将元素聚合在一起；有些命名表示抽象，而另一些则使事物具体化；有些命名表明了角色，有些表明性质…… </p>
<p>许多人取不好名字只是因为缺乏灵感。</p>
<h1 id="给组件和元素命名"><a href="#给组件和元素命名" class="headerlink" title="给组件和元素命名"></a>给组件和元素命名</h1><p>元素的类型以及元素间的关系有一个完整的宇宙。有些是在同一层级（如左手、右手），有些则是包含的关系（如公司、员工）。有些元素依赖于另外的元素（如支付、支付方式）。而有些元素则会产生其他的元素（如账单、付款）。</p>
<p>为了揭示概念和它们的名字，我们从问一些简单的问题开始。</p>
<h2 id="问题1-3"><a href="#问题1-3" class="headerlink" title="问题1/3"></a>问题1/3</h2><p>这是什么房间？</p>
<p><img src="https://alexoliveira.cc/images/posts/software-naming/couch-in-what-room.png" alt="A couch, what room does it belong to?"></p>
<p>通过这个家具来看，很可能客厅。</p>
<p>基于一个组件，我们知道我们所在的房间的名称，这很简单。</p>
<h2 id="问题2-3"><a href="#问题2-3" class="headerlink" title="问题2/3"></a>问题2/3</h2><p>这是什么房间？</p>
<p><img src="https://alexoliveira.cc/images/posts/software-naming/toilet-in-what-room.png" alt="A toilet, what room does it belong to?"></p>
<p>根据这个物体，我们可以比较肯定的说这是洗手间。</p>
<p>看到规律了吗？房间的名称是一个标签， 它定义了房间里的内容。有了这个标签，我们不需要查看容器内部就能够知道里边有什么元素。这使得我们能够建立起我们的第一个推论：</p>
<p><strong>推论1: 容器名是关于其元素的函数（container name is a function of its elements）</strong></p>
<p>注意，这其实就是<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B">鸭子类型</a>：它有床吗? 那很可能是卧室。</p>
<p>反过来也是正确的：如果我们谈论的是一间卧室，那么它很可能有一张床。这使我们能够定义第二个推论：</p>
<p><strong>推论2: 我们可以根据容器名推断出它有哪些元素（we can infer components based on the container name）</strong></p>
<p>很明显，我们有了一些规则，让我们尝试把它们应用到隔壁的房间。</p>
<h2 id="问题3-3"><a href="#问题3-3" class="headerlink" title="问题3/3"></a>问题3/3</h2><p>这是什么房间？</p>
<p><img src="https://alexoliveira.cc/images/posts/software-naming/toilet-bed.png" alt="What room has a toilet and a bed?"></p>
<p>如果我们的系统是一所房子，那么在同一个房间里的一张床和一个马桶使得这个房间的定义变得非常非常模糊。</p>
<p>这时使用推论1和推论2好像就很难给房间命名，或许我们可以给他命名为 “奇怪室”。</p>
<p>根据我的经验，大多数时候命名的难题都是由于糟糕的建模造成的。当软件中的元素没有被连贯且合乎逻辑地被引入时，有一个好的命名几乎是不可能的。<strong>由于排期很紧，开发者被迫先想到什么就交付什么。</strong></p>
<p>在家里，我们把具有相同功能、目的和意图的元素放在一起。这使得组织变得更容易，然而通过混淆这些元素的职责，我们不能确定作者想要什么元素或者如何使用这些元素，从而阻塞了流程。</p>
<p><strong>推论3: 容器定义的清晰程度与其组件的紧密程度成正比（the clarity with which a container is defined is proportional to how closely related its components are）</strong></p>
<p><img src="https://alexoliveira.cc/images/posts/software-naming/clarity-vs-relation.png" alt="Clarity vs relation"></p>
<p>当组件间相互关联时，就更容易找到一个好的命名。而当事物间没有关联时，起名就变得很难。</p>
<p>这里所说的 “关联” 可以是它们的功能、目的、策略、类型或其他的任何方面。在讨论标准之前，”关联” 这个词本身没有多大意义。我们稍后就会讲到它。</p>
<p>请注意，如果我们的系统是一座监狱，而不是一所房子，这些假设就会颠倒过来。在这个场景下，读者很容易就能认出这个房间是一件牢房。这就引出了另外一个重要推论：</p>
<p><strong>推论4: 一个容器的定义受上下文约束（a container definition is constrained to its context）</strong></p>
<p>当我们只关注容器的定义时，这个推论是显而易见的，但其实还有一个问题：系统通常不定义上下文。</p>
<p>当大多数代码结构是打平的时，上下文的定义就会丢失，从而淡化了容器之间的区别。这导致 “提示某段代码该去哪里去看的提示不存在”，所以感觉代码是随机的。</p>
<p>可以想象，如果所有的业务逻辑都打平在一个类中实现，那基本是不可读的。</p>
<p>这样的实现鼓励了开发人员在任何地方添加代码，因为没有层级提示。就像  Alan Kay 所说的:</p>
<blockquote>
<p>如今的大多数软件很像埃及金字塔，由数百万块砖头堆砌而成，没有任何的结构完整性，只是由蛮力和成千上万的奴隶完成的。</p>
<p>Most software today is very much like an Egyptian pyramid with millions of bricks piled on top of each other, with no structural integrity, but just done by brute force and thousands of slaves.</p>
</blockquote>
<p><strong>例1: HTTP domain and a car</strong></p>
<p>HTTP 是一个有 request 和 responses 的域。如果我们往里边放进了一个叫做 “汽车” 的组件，我们就不能再称它为 HTTP 了。在这种情况下，它变得令人困惑。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WhatIsAGoodNameForThis</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* methods for a car */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">gas</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">brake</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* methods for an HTTP client */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Response <span class="title">makeGetRequest</span><span class="params">(String param)</span></span>;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://alexoliveira.cc/images/posts/software-naming/car-http.png" alt="img"></p>
<p><strong>例2: Coupling through words</strong></p>
<p>一个常见的模式是在类名后加个 “Builder” 或者其他 er 结尾的单词，比如 SomethingBuilder、UserBuilder,、AccountBuilder、AccountCreator、UserHelper、JobPerformer……</p>
<p><img src="https://alexoliveira.cc/images/posts/software-naming/builders.png" alt="img"></p>
<p>通过类名来判断，我们可以知道三件事。</p>
<p>首先，类名中的动词 build 意味着它是一个函数（当然实际上 build 只是类名中的片段）。函数负责做事情，类则包含实体和上下文。函数不是实体，如果没有很好的定义实体，代码库很快就会发展成过程代码，因为它没有充分利用 “class pattern” 的初衷（面向对象）。</p>
<p>其次，它有两个内部的、隐式的实体，即 User 和 Builder，这意味着可能违背封装原则。我们的意思是 User 不应该负责生成新的 User。</p>
<p>第三，它意味着 Builder 可以访问 User 的内部的函数，因为它们毕竟是互相绑在一起的。</p>
<p>我已经看到整个代码库都充斥着这种代码。有一些复杂的模式试图解决这个问题，比如 <strong>Factory Pattern</strong>。许多时候它们是很有用的，但当我们遇到建模问题时，我们最好是修复它，而不是给它打个创可贴。</p>
<p><strong>例 3: Base</strong></p>
<p>让我们看一个真实代码的例子。第一个是 Ruby gem 的代码 <a target="_blank" rel="noopener" href="https://github.com/svenfuchs/i18n/blob/master/lib/i18n.rb">I18n</a>（为了简洁起见，只列出类和方法名）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class Base</span><br><span class="line">  def config</span><br><span class="line">  def translate</span><br><span class="line">  def locale_available?(locale)</span><br><span class="line">  def transliterate</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p><img src="https://alexoliveira.cc/images/posts/software-naming/base.png" alt="img"></p>
<p>在这个例子中， <em><strong>Base</strong></em> 并没有传达出什么意思。它可以 <em>config</em>，可以 <em>translate</em>，以及可以确定 <em>local</em> 是否可用。它做了一些不同的、不相关的事情。</p>
<p><strong>例4: names guiding design</strong></p>
<p>当我们谈到命名如何指导我们的设计时，Discourse 上有几个例子，其中一个很有意思。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostAlerter</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">notify_post_users</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">notify_group_summary</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">notify_non_pm_users</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">create_notification</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">unread_posts</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">unread_count</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">group_stats</span></span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>“PostAlerter” 的命名暗示了它的功能可能是：”alert” 某人关于某个 “post”。然而，<em>unread_posts</em>、<em>unread_count</em>、和 <em>group_stats</em> 显然是要处理其他东西，这使得这个类名不适合它所做的事情。将这三个方法转移到一个名为 <em>PostsStatistics</em>  的类中，使得这一切变得更加清晰和可预测。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostAlerter</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">notify_post_users</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">notify_group_summary</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">notify_non_pm_users</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">create_notification</span></span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostsStatistics</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">unread_posts</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">unread_count</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">group_stats</span></span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p><strong>例5: ambiguous names</strong></p>
<p>Spring 框架中也有几个例子，一个组件做了太多的事情，因此需要类似于我们上文中的 “奇怪室” 的名称。</p>
<p>可以看<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/2.5.x/javadoc-api/org/springframework/aop/config/SimpleBeanFactoryAwareAspectInstanceFactory.html">这个例子</a>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class SimpleBeanFactoryAwareAspectInstanceFactory &#123;</span><br><span class="line">  public ClassLoader getAspectClassLoader()</span><br><span class="line">  public Object getAspectInstance()</span><br><span class="line">  public int getOrder() </span><br><span class="line">  public void setAspectBeanName(String aspectBeanName) </span><br><span class="line">  public void setBeanFactory(BeanFactory beanFactory)</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>例6: good naming, for a change</strong></p>
<p>不好的命名我们已经说的够多了，我们再来看看好的命名。</p>
<p> D3 的 <a target="_blank" rel="noopener" href="https://github.com/d3/d3-shape/blob/master/src/arc.js">arc</a> 命名就很好，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">  arc.centroid     = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  arc.innerRadius  = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  arc.outerRadius  = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  arc.cornerRadius = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  arc.padRadius    = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  arc.startAngle   = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  arc.endAngle     = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  arc.padAngle     = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="keyword">return</span> arc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这些方法中的每一个都是完全有意义的：它们都是以弧的名称命名的。我喜欢下边这张图，因为它太简洁了。</p>
<p><img src="https://alexoliveira.cc/images/posts/software-naming/arc.png" alt="img"></p>
<hr>
<p>接下来讲讲当我们起名遇到麻烦时，可以怎么办。</p>
<h3 id="办法1-拆分"><a href="#办法1-拆分" class="headerlink" title="办法1: 拆分"></a>办法1: 拆分</h3><p><img src="https://alexoliveira.cc/images/posts/software-naming/divide-and-name.png" alt="Divide and... name"></p>
<p><strong>何时使用</strong>：你不能为一个类或者组件找到一个好的名字，但是你已经有了一些孤立的概念，并希望为它们的分组找到合适的名称。</p>
<p>这个方法由两部组成：</p>
<ol>
<li>明确已有的概念</li>
<li>把它们分开</li>
</ol>
<p>在 “马桶 + 床” 的场景中，我们把不同的东西分开：把床推到左边，把马桶推到右边。现在我们有了两个独立的东西，我们终于可以用自然的方式来推理了。</p>
<p>当你不能为某个东西找到一个好名字时，很可能是因为有不仅一个东西摆在你面前。而且，正如你现在知道的，给多个事物起名字是很难的。当遇到麻烦时，试着找出你面前的东西由哪些部分和行为组成。</p>
<p><strong>举例</strong></p>
<p>我们有一个未命名的类，它里边包含了 <em>request</em>、<em>response</em>、<em>headers</em>、<em>URLs</em>、<em>body</em>、<em>caching</em> 和 <em>timeout</em>。把所有这些从主类中分离出来，只剩下组件 <code>Request</code>、 <code>Response</code>、 <code>Headers</code>、 <code>URLs</code>、 <code>ResponseBody</code>、 <code>Cache</code>、 <code>Timeout</code>。如果摆在我们面前的只是这些类的名称，我们可以相当肯定地假设我们正在处理一个 web 请求。</p>
<p><code>HTTPClient</code>是 web 请求组件的一个很好的命名。</p>
<p>当代码难写时，不要直接考虑整体，先想想部分。</p>
<h3 id="办法2-发现新的概念"><a href="#办法2-发现新的概念" class="headerlink" title="办法2: 发现新的概念"></a>办法2: 发现新的概念</h3><p><img src="https://alexoliveira.cc/images/posts/software-naming/compound-concepts.png" alt="Compound concept"></p>
<p><strong>何时使用</strong>：当一个类不简洁或不条理清晰的时候。</p>
<p>发现新的概念需要有业务领域的知识。当软件应用与业务相同的术语时，就形成了一种普遍存在的语言（Evans，2003），这种语言允许来自不同专业领域的专业人士使用相同的术语。</p>
<p><strong>例1: 将组件封装到一个新概念中</strong></p>
<p>几年前，一家公司差点失去一份大合同，因为团队在发布新功能和修复 bug 方面进展缓慢。</p>
<p>这个电子商务市场通过多个支付网关，根据不同国家的不同规则向学生收取费用，需求相当复杂。</p>
<p>当我看到这个收费代码  <code>PaymentGateway</code> 时，我震惊于它是多么地复杂，有多个依赖项，包括：<code>User</code>、 <code>UserAddress</code>、 <code>CreditCard</code>、 <code>BillingAddress</code>、 <code>SellerAddress</code>、 <code>LineItems</code>、 <code>Discounts</code>，等等。它的构造函数是巨大的，这种复杂性使得添加新规则变得困难，因为修改一个东西就会破坏其他东西，并且需要我们更改所有网关适配器。</p>
<p>这个问题已经超出了支付的范畴。通过让 messaging class 再次聚合这些数据的方式，他们向学生发送了电子邮件。技术支持部门有自己的数据大盘屏幕，他们第三次聚合了这些数据，除了这个特定的地方使用了一个名为 <code>Aggregator</code>  的类（如果没有上下文，这个词就没有意义）。我们必须要点什么来解决这个架构上的障碍。</p>
<p>为了解决这个问题，我先是做了一个思维练习。以下是思维的过程：</p>
<blockquote>
<p>（假设我就身处在 <code>PaymentGateway</code>的世界里，在我面前是我需要你( <code>PaymentGateway</code>)为我收费的细节。如果这是一张桌子，我会把这些文件整理好，我可能会叫它们发票（Invoices）。所以，如果我创建一个名为<code>Invoice</code>的类会怎么样呢？它只不过是所有这些细节的集合，这样网关就不需要知道这些规则是如何起作用的，因为<code>Invoice</code>类会搞定这些？不用注入一百万个对象，我只给你一个？</p>
<p>Here I am, with these details about things I need you (the <code>PaymentGateway</code>) to charge for me. If this was a desk, I’d have these papers organized and I’d probably call them Invoices. So what if I created one class called <code>Invoice</code>, which is nothing more than the aggregation of all these other details, such that the gateway doesn’t need to know how those rules are done because <code>Invoice</code> will? Instead of injecting a million objects, I just hand one over to you?</p>
</blockquote>
<p><em>Invoice</em> 一词在任何地方都没有使用。我们花了一个月的时间进行重构，一旦我们完成了重构，我们就能够更快地修改软件。</p>
<p>Invoice 是一个 “概念” 的一个很好的例子，它是来自许多源的数据的集合，大多数人都知道它是什么。最后的解决方案添加了单独注入到网关中的<code>Invoice</code>类，作为<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Facade_pattern">外观模式</a>并隐藏其他类。</p>
<p>好的命名不仅仅是使用华丽的辞藻，而是要准确地写出需要表达的内容。</p>
<p><strong>例2: 基于业务领域的变体名称（另一种叫法）</strong></p>
<p>在一个新开发的拼车项目中，我们从头开始设计了这个系统。在研究交通解决方案的过程中，描述”某个人在某一天从出发地到目的地的一段旅程”的合适词汇是 <code>trip</code>，而把这类人叫做 <code>ride</code>。我们发布了词汇表，这样公司的其他人就可以讨论和共享相同的通用语言。</p>
<p>在项目推出后，我们的客户总是把 <code>trip</code>称为<code>rides</code>。很快我们就遇到了问题，在经历了巨大的痛苦之后，我们决定是时候把 <code>trips</code> 重构成 <code>rides</code>，把 <code>rides</code>重构成 <code>carpools</code> 了。这解决了一家公司说两种不同语言的问题。</p>
<p><strong>例3: 抽象级别</strong></p>
<p><img src="https://alexoliveira.cc/images/posts/software-naming/abstract-canvas.png" alt="img"></p>
<p>一个人说”移动右腿、然后左腿、然后右腿“；另一个人说”走路“。两者的意思相同，但后者更抽象。</p>
<p>理想情况下，随着代码越来越接近公共 API，它就越努力匹配业务上的命名方式。而当它接近数据库甚至金属时，它则使用与上下文相关的物理上的命名。在这两者之间， 有着从更多抽象到更少抽象的变化趋势。</p>
<p>在我们公司，业务人员会说 <em>post Tweet</em>，因此在公共 API 中，像 <code>postTweet()</code>这样的名称比 <code>makeHttpRequest()</code> 这样的名称更有意义。在一个有更多技术服务的公司里，后者则更合适。</p>
<p>其次，需要考虑特殊性。<code>postTweet()</code>是非常具体的，而 <code>makeHttpRequest()</code>则非常通用，它可以应用于 Facebook 或其他基本上任何涉及 HTTP 的东西。一个通用的名字可以很容易地被重复使用，但代价是含糊不清。<strong>这就解释了为什么框架代码与业务软件代码如此不同</strong>。</p>
<p><strong>例4: 泛化</strong></p>
<p>很久有钱，CMS 有  <em>news</em>、 <em>history</em>、 <em>videos</em>、 <em>articles</em>、 <em>pages</em> 等数据库表，它们中的大多数都有相同的列：<em>title</em>、<em>summary</em> 和 <em>text</em>。<em>videos</em> 表则有额外的属性，比如如 <em>url(嵌入 YouTube )<em>；</em>history</em> 表有着 <em>date</em> 属性，这样页面就会按年显示历史时间列表。所有这些表看起来都像是副本，各处都有一些细微差异，添加新功能需要重新编写大量的样板代码。</p>
<p>我将所有这些表哥折叠成一个名为 <code>contents</code> 的外键，这个外键指向了 <code>sections</code> 表，这个表中包含了 news、history、videos 等。现在，只写一个 <code>contents</code> 代码就足够了。多年后，一位朋友不得不编写一个小型的 CMS，我建议他采用相同的方法。一旦完成了用于管理内容的表单，实现任何内容所需的时间是原先所需时间的 1/N，因为对于相同类型的每个新部分，它都已经完成了。</p>
<p>通过给它另一个名字使其泛化可以提高生产率。新闻是一种 <code>contents</code>，文章是一种 <code>contents</code>，历史是一种 <code>contents</code>。这些都有相同的属性吗？是的。”调查” ？ 不，调查不属于 <code>contents</code>。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Software Complexity：Naming</p><p><a href="http://huajiaaa.com/2022/01/01/Naming/">http://huajiaaa.com/2022/01/01/Naming/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>发布于</h6><p>2022-01-01</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2022-01-03</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E7%BF%BB%E8%AF%91/">翻译</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/01/11/%E8%81%8A%E8%81%8A%E9%81%93%E7%90%86/"><span class="level-item">聊聊 &quot;道理&quot;</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="valine-thread"></div><script src="//cdn.jsdelivr.net/npm/leancloud-storage@3/dist/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.16/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread',
            appId: "EY7v6w0dFvwOqgqxWjF3WX5u-gzGzoHsz",
            appKey: "paLAHxdeEm6CAo6vlywh1MMO",
            
            avatar: "mm",
            avatarForce: false,
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "zh-CN",
            visitor: false,
            highlight: true,
            recordIP: false,
            
            
            
            enableQQ: false,
            requiredFields: [],
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/favicon/logo.svg" alt="温酒写 bug"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">温酒写 bug</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">4</p></a></div></div></nav></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/life/"><span class="level-start"><span class="level-item">life</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">技术</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-01T07:57:26.000Z">2022-01-01</time></p><p class="title"><a href="/2022/01/01/Naming/">Software Complexity：Naming</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-11T14:21:27.000Z">2021-01-11</time></p><p class="title"><a href="/2021/01/11/%E8%81%8A%E8%81%8A%E9%81%93%E7%90%86/">聊聊 &quot;道理&quot;</a></p><p class="categories"><a href="/categories/life/">life</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-11-29T06:37:59.000Z">2020-11-29</time></p><p class="title"><a href="/2020/11/29/Prometheus-tsdb/">Prometheus tsdb</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-09-15T13:36:29.000Z">2019-09-15</time></p><p class="title"><a href="/2019/09/15/2019-9-15/">我为什么会惆怅</a></p><p class="categories"><a href="/categories/life/">life</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">九月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/prometheus/"><span class="tag">prometheus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%A7%E7%9B%91%E6%8E%A7/"><span class="tag">大监控</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BF%BB%E8%AF%91/"><span class="tag">翻译</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9A%8F%E7%AC%94/"><span class="tag">随笔</span><span class="tag">2</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/favicon/logo.svg" alt="温酒写 bug" height="28"></a><p class="is-size-7"><span>&copy; 2022 温酒写 bug</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>